(function(f){var a={};var d={};var h=1000*1024;var e={action:"gnetwork_media",file:"#gnetwork-media-file-upload",name:"#gnetwork-media-file-name",submit:"#gnetwork-media-file-submit",progress:"#gnetwork-media-file-progress",},g={complete:function(i){var k=f(e.submit),j=f(e.progress).prev(".spinner");f.ajax({type:"GET",url:ajaxurl,data:{action:e.action,what:"upload_complete",file:i,nonce:k.data("nonce")},beforeSend:function(l){j.addClass("is-active")},success:function(l){j.removeClass("is-active");if(l.success){b.io(e.progress,l.data)}else{b.io(e.progress,l.data);console.log(l)}}})},},b={sp:function(l){var j=Array.prototype.slice.call(arguments,1),k=0;return l.replace(/%s/g,function(){return j[k++]})},tP:function(j){var i="Û°".charCodeAt(0);return j.toString().replace(/\d+/g,function(k){return k.split("").map(function(l){return String.fromCharCode(i+parseInt(l))}).join("")})},io:function(j,i){f(j).fadeOut("fast",function(){f(this).html(i).fadeIn()})},};f(e.file).change(function(){var i=f(this).val();if(""!=i){f(e.name).html(i).show();f(e.submit).removeClass("disabled")}else{f(e.name).html("").hide();f(e.submit).addClass("disabled")}});f(e.submit).on("click",function(i){i.preventDefault();a=new FileReader();d=document.querySelector(e.file).files[0];c(0)});function c(k){var j=k+h+1;var i=d.slice(k,j);a.onloadend=function(l){if(l.target.readyState!==FileReader.DONE){return}var m=f(e.submit);f.ajax({url:ajaxurl,type:"POST",dataType:"json",cache:false,data:{action:e.action,what:"upload_chaunk",file_data:l.target.result,file:d.name,file_type:d.type,chunk:k,nonce:m.data("nonce")},error:function(n,p,o){console.log(n,p,o)},success:function(o){if(o.success){var p=k+h;var n=Math.floor((p/d.size)*100);if(j<d.size){if("fa_IR"==m.data("locale")){n=b.tP(n)}b.io(e.progress,b.sp(m.data("progress"),n));c(j)}else{f(e.name).html("").hide();f(e.submit).addClass("disabled");b.io(e.progress,m.data("complete"));g.complete(d.name)}}else{b.io(e.progress,o.data);console.log(o)}}})};a.readAsDataURL(i)}})(jQuery);